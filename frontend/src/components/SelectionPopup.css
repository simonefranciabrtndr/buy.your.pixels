.selection-popup {
  position: fixed;
  /* horizontal positioning (left or right) will be supplied via inline styles from the component */
  width: 420px;
  --popup-radius: 26px;
  --close-gap: 14px;
  --close-size: calc(var(--popup-radius) * 2);
  --popup-bg: rgba(20,20,30,0.6);
  background: var(--popup-bg);
  backdrop-filter: blur(28px) saturate(180%);
  border-radius: var(--popup-radius);
  box-shadow:
    0 8px 32px rgba(0,0,0,0.45),
    0 0 22px rgba(255,165,0,0.4);
  color: white;
  padding: 34px;
  font-family: "SF Pro Display",-apple-system,BlinkMacSystemFont,sans-serif;
  text-align: center;
  z-index: 200;
  transition: top 0.28s ease, left 0.28s ease, transform 0.28s ease;
  will-change: top, left;
  animation: fadeIn 0.3s ease-in-out;
}

.selection-popup.payment-mode {
  width: min(860px, calc(100vw - 64px));
  max-height: calc(100vh - 64px);
  padding: 42px 48px;
  overflow-y: auto;
  text-align: left;
}

.selection-popup.payment-mode .popup-body {
  text-align: left;
}
@keyframes fadeIn {
  from {opacity:0;transform:translateY(-10px)scale(0.98);}
  to {opacity:1;transform:translateY(0)scale(1);}
}

.popup-body h3 {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 24px;
}

.popup-size{
  font-size:14px;
  font-weight:500;
  letter-spacing:0.05em;
  margin-bottom:6px;
  color:rgba(255,255,255,0.82);
}

.popup-area{
  font-size:12px;
  letter-spacing:0.05em;
  color:rgba(255,255,255,0.6);
  margin-bottom:18px;
  text-transform:uppercase;
}

.popup-body.link-step{display:flex;flex-direction:column;align-items:stretch;gap:26px;text-align:left;padding:0 6px;}
.payment-step{display:flex;flex-direction:column;gap:18px;text-align:left;width:100%;padding:0;}
.payment-step h3{text-align:left;font-size:22px;margin-bottom:4px;}
.payment-step-sub{font-size:13px;color:rgba(255,255,255,0.65);margin-bottom:6px;}
.payment-loader{padding:20px;border-radius:18px;background:rgba(255,255,255,0.08);text-align:center;letter-spacing:0.03em;}
.payment-summary{display:flex;gap:24px;padding:18px 22px;border-radius:18px;background:rgba(10,12,22,0.85);border:1px solid rgba(255,255,255,0.08);}
.payment-summary > div{display:flex;flex-direction:column;gap:4px;}
.payment-summary-label{font-size:11px;letter-spacing:0.08em;text-transform:uppercase;color:rgba(255,255,255,0.6);}
.payment-provider-card{padding:22px;border-radius:20px;background:linear-gradient(160deg,rgba(17,19,30,0.92),rgba(10,11,22,0.88));border:1px solid rgba(255,255,255,0.08);box-shadow:0 22px 36px rgba(0,0,0,0.28);}
.payment-provider-card h4{font-size:16px;font-weight:600;margin-bottom:12px;}
.stripe-payment-form{display:flex;flex-direction:column;gap:16px;}
.payment-error{margin-top:8px;padding:18px 20px;border-radius:16px;background:rgba(255,76,76,0.12);border:1px solid rgba(255,99,99,0.4);font-size:13px;color:rgba(255,160,160,0.95);}
.payment-retry-buttons{display:flex;gap:12px;margin-top:12px;}
.payment-footer{display:flex;justify-content:flex-end;gap:12px;margin-top:16px;}
.link-input-card{display:flex;flex-direction:column;gap:12px;padding:26px 26px 24px;border-radius:26px;background:linear-gradient(160deg,rgba(20,23,40,0.92),rgba(10,12,26,0.88));box-shadow:0 20px 36px rgba(0,0,0,0.32), inset 0 0 0 1px rgba(255,255,255,0.05);}
.link-input-label{font-size:12px;text-transform:uppercase;letter-spacing:0.1em;color:rgba(255,255,255,0.7);}
.link-input-field{display:flex;align-items:center;padding:6px;border-radius:18px;background:rgba(5,7,16,0.92);box-shadow:inset 0 0 0 1px rgba(255,255,255,0.07), inset 0 -4px 12px rgba(0,0,0,0.45), 0 16px 28px rgba(0,0,0,0.22);transition:box-shadow .3s ease,border-color .3s ease;}
.link-input-field:focus-within{box-shadow:inset 0 0 0 1px rgba(255,165,0,0.65), inset 0 -4px 12px rgba(255,165,0,0.24),0 18px 36px rgba(255,165,0,0.12);}
.popup-input{flex:1;border:none;background:transparent;color:white;font-size:16px;font-weight:500;padding:14px 18px;border-radius:12px;outline:none;}
.popup-input::placeholder{color:rgba(255,255,255,0.35);}
.link-input-hint{font-size:12px;letter-spacing:0.04em;color:rgba(255,255,255,0.48);}
.nsfw-toggle-card{display:flex;align-items:center;justify-content:space-between;padding:22px 26px;border-radius:26px;background:linear-gradient(160deg,rgba(18,21,36,0.94),rgba(12,15,28,0.88));box-shadow:inset 0 0 0 1px rgba(255,255,255,0.07),0 20px 36px rgba(0,0,0,0.28);transition:all .3s ease;}
.nsfw-toggle-card.active{box-shadow:inset 0 0 0 1px rgba(43,187,67,0.5),0 20px 40px rgba(43,187,67,0.25);}
.nsfw-text{display:flex;flex-direction:column;gap:4px;text-align:left;}

.nsfw-title {
  font-size:14px;
  font-weight:600;
  letter-spacing:0.04em;
}

.nsfw-sub {
  font-size:12px;
  color:rgba(255,255,255,0.6);
  letter-spacing:0.03em;
}

.nsfw-toggle {
  position:relative;
  width:70px;
  height:34px;
  border-radius:999px;
  border:none;
  background:linear-gradient(135deg, rgba(60,65,80,0.6), rgba(20,25,35,0.6));
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.35), 0 6px 18px rgba(0,0,0,0.45);
  padding:0;
  cursor:pointer;
  transition:all 0.3s ease;
}

.nsfw-toggle::before {
  content:"";
  position:absolute;
  inset:2px;
  border-radius:999px;
  background:rgba(255,255,255,0.08);
  transition:all 0.3s ease;
}

.nsfw-toggle-slider {
  position:absolute;
  top:50%;
  left:4px;
  width:29px;
  height:26px;
  border-radius:18px;
  background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.7), rgba(255,255,255,0.15));
  box-shadow:0 8px 16px rgba(0,0,0,0.35), inset 0 0 1px rgba(255,255,255,0.4);
  transform:translateY(-50%);
  transition:all 0.32s cubic-bezier(0.4,0.2,0.2,1);
}

.nsfw-toggle.active {
  background:linear-gradient(135deg, rgba(43, 187, 67, 0.9), rgba(30, 160, 50, 0.85));
  box-shadow:0 10px 24px rgba(45, 200, 70, 0.4), inset 0 2px 4px rgba(255,255,255,0.18);
}

.nsfw-toggle.active::before {
  background:linear-gradient(135deg, rgba(255,255,255,0.35), rgba(255,255,255,0.12));
  box-shadow:0 0 18px rgba(45, 200, 70, 0.5);
}

.nsfw-toggle.active .nsfw-toggle-slider {
  left:36px;
  background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.95), rgba(255,255,255,0.2));
  box-shadow:0 12px 26px rgba(45, 200, 70, 0.45), inset 0 0 1px rgba(255,255,255,0.6);
}

.popup-buy,.popup-continue,.popup-skip{
  background:linear-gradient(135deg,#0a84ff,#0066ff);
  border:none;border-radius:14px;
  padding:10px 20px;font-size:15px;
  cursor:pointer;font-weight:600;color:#fff;
  box-shadow:0 0 18px rgba(0,102,255,.6);
  transition:all .3s ease;margin-top:20px;
}
.popup-buy:hover,.popup-continue:hover,.popup-skip:hover{
  transform:scale(1.05);box-shadow:0 0 22px rgba(255,165,0,.7);
}
.popup-buttons{display:flex;justify-content:center;gap:16px;margin-top:20px;}
.popup-skip{background:rgba(255,255,255,0.2);color:white;box-shadow:none;}
.popup-buttons.link-buttons{margin-top:8px;}

.upload-zone {
  display:flex;align-items:center;justify-content:center;
  border:2px dashed rgba(255,255,255,0.4);
  border-radius:16px;
  padding:30px;
  color:rgba(255,255,255,0.8);
  font-size:16px;
  cursor:pointer;
  transition:all .3s ease;
}
.upload-zone.dragging{
  border-color:rgba(255,165,0,0.9);
  background:rgba(255,165,0,0.12);
  color:#fff;
}
.upload-zone:hover{border-color:rgba(255,165,0,.9);transform:scale(1.02);}
.uploaded-preview{width:100%;border-radius:12px;object-fit:cover;}

/* Preview Modal */
.preview-overlay {
  position:fixed;top:0;left:0;width:100%;height:100%;
  background:rgba(0,0,0,0.7);backdrop-filter:blur(20px);
  display:flex;justify-content:center;align-items:center;
  z-index:300;
}
.preview-modal {
  background:rgba(25,25,35,0.8);
  border-radius:20px;
  padding:30px;
  width:500px;
  text-align:center;
  box-shadow:0 0 25px rgba(255,165,0,0.4);
  animation:fadeIn .3s ease-in-out;
}
.preview-image-large {
  width:100%;
  border-radius:16px;
  box-shadow:0 0 18px rgba(255,165,0,0.4);
}
.preview-link {
  display:block;
  margin-top:12px;
  color:#0a84ff;
  font-size:14px;
  text-decoration:none;
  word-break:break-all;
}
.preview-link:hover{text-decoration:underline;}

.close-btn{
  position:absolute;
  top:auto;bottom:auto;left:auto;right:auto;
  width:var(--close-size);
  height:var(--close-size);
  border-radius:var(--popup-radius);
  background:var(--popup-bg);
  border:1px solid rgba(255,165,0,0.38);
  color:#fff;
  font-size:20px;
  line-height:1;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  backdrop-filter:blur(10px);
  box-shadow:
    inset 0 0 14px rgba(0,0,0,0.4),
    0 0 18px rgba(255,165,0,0.36);
  transition:all .22s ease;
}
.close-btn:hover{
  background:rgba(255,255,255,0.18);
  transform:scale(1.05);
}

.selection-popup.payment-mode .close-btn{
  position:absolute;
  top:var(--close-gap);
  right:var(--close-gap);
  left:auto;
  bottom:auto;
  width:var(--close-size);
  height:var(--close-size);
  border-radius:var(--popup-radius);
  background:var(--popup-bg);
  border:1px solid rgba(255,165,0,0.38);
  box-shadow:
    inset 0 0 14px rgba(0,0,0,0.4),
    0 0 18px rgba(255,165,0,0.36);
  color:#fff;
}

.selection-popup.payment-mode .close-btn:hover{
  background:rgba(255,255,255,0.18);
  border-color:rgba(255,165,0,0.6);
}

.popup-link-preview{
  margin-top:24px;
  display:flex;
  flex-direction:column;
  gap:12px;
  text-align:left;
}

.popup-preview-card{
  padding:18px 20px 20px;
  border-radius:16px;
  background:rgba(14,16,24,0.92);
  border:1px solid rgba(255,165,0,0.35);
  box-shadow:0 18px 32px rgba(0,0,0,0.4),0 0 22px rgba(255,165,0,0.28);
  font-family:"SF Pro Display",-apple-system,BlinkMacSystemFont,sans-serif;
  backdrop-filter:blur(18px) saturate(160%);
}

.popup-preview-thumb{
  width:100%;
  height:160px;
  border-radius:12px;
  overflow:hidden;
  margin-bottom:12px;
  position:relative;
  box-shadow:0 14px 22px rgba(0,0,0,0.35), inset 0 0 0 1px rgba(255,255,255,0.04);
  background:rgba(255,255,255,0.04);
}

.popup-preview-thumb img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

.popup-preview-thumb.placeholder{
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
  color:rgba(255,255,255,0.55);
  background:rgba(255,165,0,0.08);
}

.popup-preview-thumb.placeholder img{
  width:54px;
  height:54px;
  object-fit:contain;
}

.popup-preview-thumb.blurred img,
.popup-preview-thumb.blurred span{
  filter:blur(12px);
  opacity:0;
}

.popup-preview-thumb.blurred::after{
  content:"Blurred preview";
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:12px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  color:rgba(255,255,255,0.85);
  background:rgba(11,13,18,0.62);
}

.popup-preview-domain{
  font-size:13px;
  letter-spacing:0.08em;
  text-transform:uppercase;
  color:rgba(255,255,255,0.72);
  margin-bottom:6px;
}

.popup-preview-title{
  font-size:17px;
  font-weight:600;
  color:rgba(255,255,255,0.95);
  margin-bottom:8px;
  max-width:100%;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

.popup-preview-description{
  font-size:14px;
  color:rgba(255,255,255,0.7);
  line-height:1.5;
  margin-bottom:10px;
}

.popup-preview-open-hint{
  font-size:12px;
  letter-spacing:0.05em;
  text-transform:uppercase;
  color:rgba(255,255,255,0.55);
}

.popup-preview-hint{
  font-size:13px;
  color:rgba(255,255,255,0.78);
  letter-spacing:0.02em;
}

.popup-preview-hint.error{
  color:rgba(255,120,120,0.85);
}

.selection-popup.corner-top-left .close-btn{
  top: var(--close-gap);
  left: var(--close-gap);
}
.selection-popup.corner-top-right .close-btn{
  top: var(--close-gap);
  right: var(--close-gap);
}
.selection-popup.corner-bottom-left .close-btn{
  bottom: var(--close-gap);
  left: var(--close-gap);
}
.selection-popup.corner-bottom-right .close-btn{
  bottom: var(--close-gap);
  right: var(--close-gap);
}
